function [rx,ry] = vnewton2(x0,itmax,tol)
r=zeros(itmax+1,1);
x=x0;r(1,1)=norm(f(x0));
fprintf('\n');
disp(' iter  L2 norm of f(x)')
fprintf('%4.0f',0)
fprintf('%19.14f',r(1,1))
fprintf('\n');
for k=1:itmax
    J=jacobian(x);rhs=-f(x);
    delta=J\rhs;
    x=x+delta;
    r(k+1,1)=norm(f(x));
    fprintf('%4.0f',k)
    fprintf('%19.14f',r(k+1,1))
    fprintf('\n');
    if abs(r(k+1,1))<=tol
        fprintf('\n');
        disp(['Method has converged after ',num2str(k),' iterations.'])
        break
    end
end

if abs(r(k+1,1))>tol
    fprintf('\n');
    disp(['Method has NOT converged after ',num2str(k),' iterations.'])
end
fprintf('\n');
disp('Solution vector:')
x
rx=zeros(k,1);ry=zeros(k,1);
for i=1:k
    rx(i,1)=r(i,1);
    ry(i,1)=r(i+1,1);
end

function y=f(x)
y(1,1)=((25-x(1)*10^x(2))*10^x(2)+(70-x(1)*20^x(2))*20^x(2)+(380-x(1)*30^x(2))*30^x(2)+(550-x(1)*40^x(2))*40^x(2)+(610-x(1)*50^x(2))*50^x(2)+(1220-x(1)*60^x(2))*60^x(2)+(830-x(1)*70^x(2))*70^x(2)+(1450-x(1)*80^x(2))*80^x(2));
y(2,1)=(10^x(2)*log(10)*(25-x(1)*10^x(2))+(20^x(2)*log(20)*(70-x(1)*20^x(2)))+(30^x(2)*log(30)*(380-x(1)*30^x(2)))+(40^x(2)*log(40)*(550-x(1)*40^x(2)))+(50^x(2)*log(50)*(610-x(1)*50^x(2)))+(60^x(2)*log(60)*(1220-x(1)*60^x(2)))+(70^x(2)*log(70)*(830-x(1)*70^x(2)))+(80^x(2)*log(80)*(1450-x(1)*80^x(2))));

function J=jacobian(x)
n=length(x);
J=zeros(n,n);
J(1,1) = - 10^(2*x(2)) - 20^(2*x(2)) - 30^(2*x(2)) - 40^(2*x(2)) - 50^(2*x(2)) - 60^(2*x(2)) - 70^(2*x(2)) - 80^(2*x(2));
J(1,2) = - (2592480341699211*10^(2*x(2)))/1125899906842624 - (6745789375439761*20^(2*x(2)))/2251799813685248 - (7658815630333595*30^(2*x(2)))/2251799813685248 - (8306618067481101*40^(2*x(2)))/2251799813685248 - (8809092674755503*50^(2*x(2)))/2251799813685248 - (4609822161187467*60^(2*x(2)))/1125899906842624 - (4783380397244705*70^(2*x(2)))/1125899906842624 - (1233430844940305*80^(2*x(2)))/281474976710656;
J(2,1) = - 10^(2*x(2))*x(1)*log(10) - 20^(2*x(2))*x(1)*log(20) - 30^(2*x(2))*x(1)*log(30) - 40^(2*x(2))*x(1)*log(40) - 50^(2*x(2))*x(1)*log(50) - 60^(2*x(2))*x(1)*log(60) - 70^(2*x(2))*x(1)*log(70) - 80^(2*x(2))*x(1)*log(80) - 10^x(2)*log(10)*(10^x(2)*x(1) - 25) - 20^x(2)*log(20)*(20^x(2)*x(1) - 70) - 30^x(2)*log(30)*(30^x(2)*x(1) - 380) - 40^x(2)*log(40)*(40^x(2)*x(1) - 550) - 50^x(2)*log(50)*(50^x(2)*x(1) - 610) - 70^x(2)*log(70)*(70^x(2)*x(1) - 830) - 60^x(2)*log(60)*(60^x(2)*x(1) - 1220) - 80^x(2)*log(80)*(80^x(2)*x(1) - 1450);
J(2,2) = - (2592480341699211*10^(2*x(2))*x(1)*log(10))/1125899906842624 - (6745789375439761*20^(2*x(2))*x(1)*log(20))/2251799813685248 - (7658815630333595*30^(2*x(2))*x(1)*log(30))/2251799813685248 - (8306618067481101*40^(2*x(2))*x(1)*log(40))/2251799813685248 - (8809092674755503*50^(2*x(2))*x(1)*log(50))/2251799813685248 - (4609822161187467*60^(2*x(2))*x(1)*log(60))/1125899906842624 - (4783380397244705*70^(2*x(2))*x(1)*log(70))/1125899906842624 - (1233430844940305*80^(2*x(2))*x(1)*log(80))/281474976710656 - (2592480341699211*10^x(2)*log(10)*(10^x(2)*x(1) - 25))/1125899906842624 - (6745789375439761*20^x(2)*log(20)*(20^x(2)*x(1) - 70))/2251799813685248 - (7658815630333595*30^x(2)*log(30)*(30^x(2)*x(1) - 380))/2251799813685248 - (8306618067481101*40^x(2)*log(40)*(40^x(2)*x(1) - 550))/2251799813685248 - (8809092674755503*50^x(2)*log(50)*(50^x(2)*x(1) - 610))/2251799813685248 - (4783380397244705*70^x(2)*log(70)*(70^x(2)*x(1) - 830))/1125899906842624 - (4609822161187467*60^x(2)*log(60)*(60^x(2)*x(1) - 1220))/1125899906842624 - (1233430844940305*80^x(2)*log(80)*(80^x(2)*x(1) - 1450))/281474976710656;